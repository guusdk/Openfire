ALTER TABLE ofMucService ADD privateKey NVARCHAR(255);

UPDATE ofMucService SET privateKey = (
    SELECT TOP 1
          SUBSTRING('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789', ABS(CHECKSUM(NEWID())) % 62 + 1, 1) +
          SUBSTRING('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789', ABS(CHECKSUM(NEWID())) % 62 + 1, 1) +
          SUBSTRING('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789', ABS(CHECKSUM(NEWID())) % 62 + 1, 1) +
          SUBSTRING('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789', ABS(CHECKSUM(NEWID())) % 62 + 1, 1) +
          SUBSTRING('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789', ABS(CHECKSUM(NEWID())) % 62 + 1, 1) +
          SUBSTRING('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789', ABS(CHECKSUM(NEWID())) % 62 + 1, 1) +
          SUBSTRING('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789', ABS(CHECKSUM(NEWID())) % 62 + 1, 1) +
          SUBSTRING('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789', ABS(CHECKSUM(NEWID())) % 62 + 1, 1) +
          SUBSTRING('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789', ABS(CHECKSUM(NEWID())) % 62 + 1, 1) +
          SUBSTRING('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789', ABS(CHECKSUM(NEWID())) % 62 + 1, 1) +
          SUBSTRING('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789', ABS(CHECKSUM(NEWID())) % 62 + 1, 1) +
          SUBSTRING('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789', ABS(CHECKSUM(NEWID())) % 62 + 1, 1) +
          SUBSTRING('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789', ABS(CHECKSUM(NEWID())) % 62 + 1, 1) +
          SUBSTRING('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789', ABS(CHECKSUM(NEWID())) % 62 + 1, 1) +
          SUBSTRING('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789', ABS(CHECKSUM(NEWID())) % 62 + 1, 1) +
          SUBSTRING('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789', ABS(CHECKSUM(NEWID())) % 62 + 1, 1) +
          SUBSTRING('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789', ABS(CHECKSUM(NEWID())) % 62 + 1, 1) +
          SUBSTRING('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789', ABS(CHECKSUM(NEWID())) % 62 + 1, 1) +
          SUBSTRING('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789', ABS(CHECKSUM(NEWID())) % 62 + 1, 1) +
          SUBSTRING('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789', ABS(CHECKSUM(NEWID())) % 62 + 1, 1) +
          SUBSTRING('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789', ABS(CHECKSUM(NEWID())) % 62 + 1, 1)
    );

ALTER TABLE ofMucService ALTER COLUMN privateKey NVARCHAR(255) NOT NULL;

UPDATE ofVersion SET version = 38 WHERE name = 'openfire';
